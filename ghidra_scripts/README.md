### oski_decrypt_strings.py

just run the script and it will find the string decryption function and the key.
if not, put your cursor on the call to the decrypt function and optionnaly input the key.

Decryption goes like ```rc4decrypt(base64decode(str), key)```

For each encrypted string, the script will *allocate* memory in a new section and write the decrypted string there.
The pointer to the decrypted strings will be updated to reflect this, making all XREF to the decrypted string easily readable:

```C
    PTR_s_w_004321d0 = (undefined *)FUN_00422f70("LQ==");
    PTR_s_system.txt_00432608 = (undefined *)FUN_00422f70("KaoQpEzKSjGm8Q==");
    PTR_s_System_-------------------------_00432600 =
         (undefined *)FUN_00422f70("CaoQpEzKRGjzqA7oxsEfmfrFl/2dONghOeYatRN8r22RvgdoQSz2oEl19dbLETI+8RVlqBE+g42Kng==");
    PTR_s_Windows:_%s_0043236c = (undefined *)FUN_00422f70("DboNtEbQF3/+oFA=");
    PTR_s_Bit:_%s_00432494 = (undefined *)FUN_00422f70("GLoX6gmCFw==");
    PTR_s_User:_%s_00432694 = (undefined *)FUN_00422f70("D6AGohOHQTY=");
    
    
    
    
void FUN_0041fc30(void)
{
    FILE *_File;
    undefined4 uVar1;
    char *pcVar2;
    
    _File = _fopen(PTR_s_system.txt_00432608,PTR_s_w_004321d0);
    if (_File != NULL) {
        _fprintf(_File,PTR_s_System_-------------------------_00432600);
        _fprintf(_File,"\n");
        uVar1 = FUN_0041b260();
        _fprintf(_File,PTR_s_Windows:_%s_0043236c,uVar1);
        _fprintf(_File,"\n");
        uVar1 = FUN_0041b220();
        _fprintf(_File,PTR_s_Bit:_%s_00432494,uVar1);
        _fprintf(_File,"\n");
        uVar1 = FUN_0041b1e0();
        _fprintf(_File,PTR_s_User:_%s_00432694,uVar1);
        _fprintf(_File,"\n");
        uVar1 = FUN_0041b2e0();
        _fprintf(_File,PTR_s_Computer_Name:_%s_00432550,uVar1);
        _fprintf(_File,"\n");
        uVar1 = FUN_0041abd0();
        _fprintf(_File,PTR_s_System_Language:_%s_0043214c,uVar1);
        _fprintf(_File,"\n");
        uVar1 = FUN_0041b0e0();
        _fprintf(_File,PTR_s_Ma_hine_ID:_%s_0043248c,uVar1);
```

```
oski_decrypt_strings.py> Running...
guessed string decrypt addr: 0x422f70
Using key: 056139954853430408
#################
CALL 0x00422f70
ds "LQ=="
call @ 0x423078  -> w
  * pointer @ 0x423078
#################
CALL 0x00422f70
ds "KaoQpEzKSjGm8Q=="
call @ 0x42308a  -> system.txt
  * pointer @ 0x42308a
#################
CALL 0x00422f70
ds "CaoQpEzKRGjzqA7oxsEfmfrFl/2dONghOeYatRN8r22RvgdoQSz2oEl19dbLETI+8RVlqBE+g42Kng=="
call @ 0x42309c  -> System ---------------------------------------------------
  * pointer @ 0x42309c
#################
CALL 0x00422f70
ds "DboNtEbQF3/+oFA="
call @ 0x4230ae  -> Windows: %s
  * pointer @ 0x4230ae
#################
CALL 0x00422f70
ds "GLoX6gmCFw=="
call @ 0x4230c0  -> Bit: %s
  * pointer @ 0x4230c0
etc...
```
